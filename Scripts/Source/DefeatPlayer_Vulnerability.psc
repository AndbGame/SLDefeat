Scriptname DefeatPlayer_Vulnerability extends ReferenceAlias

DefeatPlayer Property DefPlayerScr Auto
Actor Property PlayerRef Auto
Float Version = 0.0

Keyword zad_DeviousPlug
Keyword zad_DeviousBelt
Keyword zad_DeviousBra
Keyword zad_DeviousCollar
Keyword zad_DeviousArmCuffs
Keyword zad_DeviousLegCuffs
Keyword zad_DeviousArmbinder
Keyword zad_DeviousHeavyBondage
Keyword zad_DeviousAnkleShackles
Keyword zad_BoundCombatDisableKick
Keyword zad_DeviousCorset
Keyword zad_DeviousSuit
Keyword zad_DeviousGag
Keyword zad_DeviousPlugVaginal
Keyword zad_DeviousPlugAnal
Keyword zad_DeviousHarness
Keyword zad_DeviousBlindfold
Keyword zad_DeviousBoots
Keyword zad_InventoryDevice

Bool Property IsWearing_Gag Auto
Bool Property IsWearing_VaginalPlug Auto
Bool Property IsWearing_AnalPlug Auto
Bool Property IsWearing_Belt Auto
Bool Property IsWearing_Bra Auto
Bool Property IsWearing_Collar Auto
Bool Property IsWearing_ArmCuffs Auto
Bool Property IsWearing_LegCuffs Auto
Bool Property IsWearing_HeavyBondage Auto
Bool Property IsWearing_BoundCombatDisableKick Auto
Bool Property IsWearing_Blindfold Auto
Bool Property IsWearing_Boots Auto
Bool Property IsWearing_Corset Auto
Bool Property IsWearing_Harness Auto

Int NumOfDevicesEquipped = 0

Float Property Vulnerability_Gag = 10.0 Auto
Float Property Vulnerability_VaginalPlug = 5.0 Auto
Float Property Vulnerability_AnalPlug = 5.0 Auto
Float Property Vulnerability_Belt = 10.0 Auto
Float Property Vulnerability_Bra = 10.0 Auto
Float Property Vulnerability_Collar = 10.0 Auto
Float Property Vulnerability_ArmCuffs = 5.0 Auto
Float Property Vulnerability_LegCuffs = 5.0 Auto
Float Property Vulnerability_HeavyBondage = 15.0 Auto
Float Property Vulnerability_BoundCombatDisableKick = 15.0 Auto
Float Property Vulnerability_Blindfold = 15.0 Auto
Float Property Vulnerability_Boots = 10.0 Auto
Float Property Vulnerability_Corset = 5.0 Auto
Float Property Vulnerability_Harness = 5.0 Auto
Float Property Vulnerability_FullChastity = 10.0 Auto
Float Property Vulnerability_Helpless = 30.0 Auto
Float Property Vulnerability_Total Auto

Event OnInit()
	RegisterForModEvent("Defeat_EnableVulnerability", "OnEnableVulnerability")
	RegisterForModEvent("Defeat_DisableVulnerability", "OnDisableVulnerability")
	DefPlayerScr = Quest.GetQuest("DefeatPlayerQST").GetAlias(0) as DefeatPlayer
	if DefPlayerScr.RessConfig.DDon
		PrepareMod()
		GoToState("VulnerabilityRunning")
		ForceReset = True
		RegisterForSingleUpdate(0.5)
	endif
EndEvent

Event OnEnableVulnerability(string eventname, string argString, float argNum, form sender)
	DefPlayerScr = Quest.GetQuest("DefeatPlayerQST").GetAlias(0) as DefeatPlayer
	DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnEnableVulnerability()")
	PrepareMod()
	GoToState("VulnerabilityRunning")
	ForceReset = True
	RegisterForSingleUpdate(0.5)
EndEvent

Event OnDisableVulnerability(string eventname, string argString, float argNum, form sender)
	DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnDisableVulnerability()")
	GoToState("Stop")
EndEvent

Function PrepareMod()
	if Version != 1.0
		SetDDKeywords()
		Version = 1.0
	endif
EndFunction

Bool DebugBusy = False
Bool ForceReset = False

State Stop

EndState

State VulnerabilityRunning

	Event OnPlayerLoadGame()
		DefPlayerScr = Quest.GetQuest("DefeatPlayerQST").GetAlias(0) as DefeatPlayer
		Utility.Wait(1)
		if DefPlayerScr.RessConfig.DDon
			PrepareMod()
			ForceReset = True
			RegisterForSingleUpdate(0.5)
		endif
	EndEvent

	Event OnUpdate()
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnUpdate()")
		if DebugBusy == false
			DebugBusy = True
			Maintenance(ForceReset)
			CalculateVulnerability()
			DebugBusy = False
			ForceReset = False
		else
			DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnUpdate() - Pending")
			RegisterForSingleUpdate(0.5)
		endif
	EndEvent
	
	Event OnObjectEquipped(Form akBaseObject, ObjectReference akReference)
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnObjectEquipped(): " + akBaseObject.GetName() + " - Start - NumOfDevicesEquipped: " + NumOfDevicesEquipped)
		if akBaseObject.HasKeyword(zad_DeviousPlugVaginal)
			IsWearing_VaginalPlug = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousPlugAnal)
			IsWearing_AnalPlug = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousGag)
			IsWearing_Gag = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBelt)
			IsWearing_Belt = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBra)
			IsWearing_Bra = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousCollar)
			IsWearing_Collar = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousArmCuffs)
			IsWearing_ArmCuffs = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousLegCuffs)
			IsWearing_LegCuffs = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousHeavyBondage)
			IsWearing_HeavyBondage = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_BoundCombatDisableKick)
			IsWearing_BoundCombatDisableKick = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBlindfold)
			IsWearing_Blindfold = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBoots)
			IsWearing_Boots = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousCorset)
			IsWearing_Corset = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousHarness)
			IsWearing_Harness = True
			NumOfDevicesEquipped += 1
			RegisterForSingleUpdate(0.5)
		endif
		if Game.GetPlayer().WornHasKeyword(zad_InventoryDevice)
			OnUpdate()
		endif
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnObjectEquipped(): " + akBaseObject.GetName() + " - End - NumOfDevicesEquipped: " + NumOfDevicesEquipped)
	EndEvent

	Event OnObjectUnequipped(Form akBaseObject, ObjectReference akReference)
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnObjectUnequipped(): " + akBaseObject.GetName() + " - Start - NumOfDevicesEquipped: " + NumOfDevicesEquipped)
		if akBaseObject.HasKeyword(zad_DeviousPlugVaginal)
			if !PlayerRef.WornHasKeyword(zad_DeviousPlugVaginal)
				IsWearing_VaginalPlug = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousPlugAnal)
			if !PlayerRef.WornHasKeyword(zad_DeviousPlugAnal)
				IsWearing_AnalPlug = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousGag)
			if !PlayerRef.WornHasKeyword(zad_DeviousGag)
				IsWearing_Gag = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBelt)
			if !PlayerRef.WornHasKeyword(zad_DeviousBelt)
				IsWearing_Belt = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBra)
			if !PlayerRef.WornHasKeyword(zad_DeviousBra)
				IsWearing_Bra = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousCollar)
			if !PlayerRef.WornHasKeyword(zad_DeviousCollar)
				IsWearing_Collar = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousArmCuffs)
			if !PlayerRef.WornHasKeyword(zad_DeviousArmCuffs)
				IsWearing_ArmCuffs = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousLegCuffs)
			if !PlayerRef.WornHasKeyword(zad_DeviousLegCuffs)
				IsWearing_LegCuffs = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousHeavyBondage)
			if !PlayerRef.WornHasKeyword(zad_DeviousHeavyBondage)
				IsWearing_HeavyBondage = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_BoundCombatDisableKick)
			if !PlayerRef.WornHasKeyword(zad_BoundCombatDisableKick)
				IsWearing_BoundCombatDisableKick = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBlindfold)
			if !PlayerRef.WornHasKeyword(zad_DeviousBlindfold)
				IsWearing_Blindfold = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousBoots)
			if !PlayerRef.WornHasKeyword(zad_DeviousBoots)
				IsWearing_Boots = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousCorset)
			if !PlayerRef.WornHasKeyword(zad_DeviousCorset)
				IsWearing_Corset = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if akBaseObject.HasKeyword(zad_DeviousHarness)
			if !PlayerRef.WornHasKeyword(zad_DeviousHarness)
				IsWearing_Harness = False
				NumOfDevicesEquipped -= 1
			endif
			RegisterForSingleUpdate(0.5)
		endif
		if Game.GetPlayer().WornHasKeyword(zad_InventoryDevice)
			UnregisterForUpdate()
			OnUpdate()
		endif
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - OnObjectUnequipped: " + akBaseObject.GetName() + " - End - NumOfDevicesEquipped: " + NumOfDevicesEquipped)
	EndEvent

EndState

Function SetDDKeywords()
	DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - SetDDKeywords()")
	zad_DeviousPlug = Game.GetFormFromFile(0x3331, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousBelt = Game.GetFormFromFile(0x3330, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousBra = Game.GetFormFromFile(0x3DFA, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousCollar = Game.GetFormFromFile(0x3DF7, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousArmCuffs = Game.GetFormFromFile(0x3DF9, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousLegCuffs = Game.GetFormFromFile(0x3DF8, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousHeavyBondage = Game.GetFormFromFile(0x5226C, "Devious Devices - Integration.esm") as Keyword
	zad_DeviousAnkleShackles = Game.GetFormFromFile(0x5F4BB, "Devious Devices - Integration.esm") as Keyword
	zad_BoundCombatDisableKick = Game.GetFormFromFile(0x58391, "Devious Devices - Integration.esm") as Keyword
	zad_DeviousCorset = Game.GetFormFromFile(0x27F28, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousGag = Game.GetFormFromFile(0x7EB8, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousPlugVaginal = Game.GetFormFromFile(0x1DD7C, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousPlugAnal = Game.GetFormFromFile(0x1DD7D, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousHarness = Game.GetFormFromFile(0x17C43, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousBlindfold = Game.GetFormFromFile(0x11B1A, "Devious Devices - Assets.esm") as Keyword
	zad_DeviousBoots = Game.GetFormFromFile(0x27F29, "Devious Devices - Assets.esm") as Keyword
	zad_InventoryDevice = Game.GetFormFromFile(0x2B5F0, "Devious Devices - Integration.esm") as Keyword
EndFunction



Function Maintenance(bool Clear = False)
	if Clear
		NumOfDevicesEquipped = 0
		if !PlayerRef.WornHasKeyword(zad_DeviousPlugVaginal)
			IsWearing_VaginalPlug = False
		else
			IsWearing_VaginalPlug = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousPlugAnal)
			IsWearing_AnalPlug = False
		else
			IsWearing_AnalPlug = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousGag)
			IsWearing_Gag = False
		else
			IsWearing_Gag = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBelt)
			IsWearing_Belt = False
		else
			IsWearing_Belt = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBra)
			IsWearing_Bra = False
		else
			IsWearing_Bra = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousCollar)
			IsWearing_Collar = False
		else
			IsWearing_Collar = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousArmCuffs)
			IsWearing_ArmCuffs = False
		else
			IsWearing_ArmCuffs = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousLegCuffs)
			IsWearing_LegCuffs = False
		else
			IsWearing_LegCuffs = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousHeavyBondage)
			IsWearing_HeavyBondage = False
		else
			IsWearing_HeavyBondage = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_BoundCombatDisableKick)
			IsWearing_BoundCombatDisableKick = False
		else
			IsWearing_BoundCombatDisableKick = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBlindfold)
			IsWearing_Blindfold = False
		else
			IsWearing_Blindfold = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBoots)
			IsWearing_Boots = False
		else
			IsWearing_Boots = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousCorset)
			IsWearing_Corset = False
		else
			IsWearing_Corset = True
			NumOfDevicesEquipped += 1
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousHarness)
			IsWearing_Harness = False
		else
			IsWearing_Harness = True
			NumOfDevicesEquipped += 1
		endif
	else
		if !PlayerRef.WornHasKeyword(zad_DeviousPlugVaginal)
			IsWearing_VaginalPlug = False
		else
			IsWearing_VaginalPlug = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousPlugAnal)
			IsWearing_AnalPlug = False
		else
			IsWearing_AnalPlug = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousGag)
			IsWearing_Gag = False
		else
			IsWearing_Gag = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBelt)
			IsWearing_Belt = False
		else
			IsWearing_Belt = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBra)
			IsWearing_Bra = False
		else
			IsWearing_Bra = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousCollar)
			IsWearing_Collar = False
		else
			IsWearing_Collar = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousArmCuffs)
			IsWearing_ArmCuffs = False
		else
			IsWearing_ArmCuffs = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousLegCuffs)
			IsWearing_LegCuffs = False
		else
			IsWearing_LegCuffs = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousHeavyBondage)
			IsWearing_HeavyBondage = False
		else
			IsWearing_HeavyBondage = True
		endif
		if !PlayerRef.WornHasKeyword(zad_BoundCombatDisableKick)
			IsWearing_BoundCombatDisableKick = False
		else
			IsWearing_BoundCombatDisableKick = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBlindfold)
			IsWearing_Blindfold = False
		else
			IsWearing_Blindfold = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousBoots)
			IsWearing_Boots = False
		else
			IsWearing_Boots = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousCorset)
			IsWearing_Corset = False
		else
			IsWearing_Corset = True
		endif
		if !PlayerRef.WornHasKeyword(zad_DeviousHarness)
			IsWearing_Harness = False
		else
			IsWearing_Harness = True
		endif
	endif
EndFunction

Float Function CalculateVulnerability()
	Float TempInt = 0
	if IsWearing_Gag
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueGag
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Gag: " + DefPlayerScr.McmConfig.VulnerabilityValueGag)
	endif
	if IsWearing_VaginalPlug
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueVagPlug
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability VaginalPlug: " + DefPlayerScr.McmConfig.VulnerabilityValueVagPlug)
	endif
	if IsWearing_AnalPlug
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueAnalPlug
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability AnalPlug: " + DefPlayerScr.McmConfig.VulnerabilityValueAnalPlug)
	endif
	if IsWearing_Belt
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueBelt
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Belt: " + DefPlayerScr.McmConfig.VulnerabilityValueBelt)
	endif
	if IsWearing_Bra
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueBra
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Bra: " + DefPlayerScr.McmConfig.VulnerabilityValueBra)
	endif
	if IsWearing_Collar
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueCollar
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Collar: " + DefPlayerScr.McmConfig.VulnerabilityValueCollar)
	endif
	if IsWearing_ArmCuffs
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueArmCuffs
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability ArmCuffs: " + DefPlayerScr.McmConfig.VulnerabilityValueArmCuffs)
	endif
	if IsWearing_LegCuffs
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueLegCuffs
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability LegCuffs: " + DefPlayerScr.McmConfig.VulnerabilityValueLegCuffs)
	endif
	if IsWearing_HeavyBondage
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueHeavyBond
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability HeavyBondage: " + DefPlayerScr.McmConfig.VulnerabilityValueHeavyBond)
	endif
	if IsWearing_BoundCombatDisableKick
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueDisableKick
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability DisableKick: " + DefPlayerScr.McmConfig.VulnerabilityValueDisableKick)
	endif
	if IsWearing_Blindfold
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueBlindfold
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Blindfold: " + DefPlayerScr.McmConfig.VulnerabilityValueBlindfold)
	endif
	if IsWearing_Boots
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueBoots
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Boots: " + DefPlayerScr.McmConfig.VulnerabilityValueBoots)
	endif
	if IsWearing_Corset
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueCorset
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Corset: " + DefPlayerScr.McmConfig.VulnerabilityValueCorset)
	endif
	if IsWearing_Harness
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueHarness
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Harness: " + DefPlayerScr.McmConfig.VulnerabilityValueHarness)
	endif
	if IsWearing_Belt && IsWearing_Bra && IsWearing_Gag
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueFullChastity
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability FullChastity: " + DefPlayerScr.McmConfig.VulnerabilityValueFullChastity)
	endif
	if IsWearing_BoundCombatDisableKick && IsWearing_HeavyBondage
		TempInt += DefPlayerScr.McmConfig.VulnerabilityValueHelpless
		DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Helpless: " + DefPlayerScr.McmConfig.VulnerabilityValueHelpless)
	endif
	Vulnerability_Total = TempInt
	if Vulnerability_Total > 100.0
		Vulnerability_Total = 100.0
	endif
	DefPlayerScr.DefeatLog("[Defeat] - DefeatPlayer_Vulnerability - CalculateVulnerability Vulnerability_Total: " + Vulnerability_Total)

	defeat_skse_api.setActorVulnerability(PlayerRef, Vulnerability_Total) ; Apply Vulnerability for skse plugin

	return Vulnerability_Total
Endfunction